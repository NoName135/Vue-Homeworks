import{m as k,_ as y,r as m,o,k as C,w,a as t,b as a,p,e as $,l as x,c as d,F as v,j as I,f as _,t as r,d as h}from"./index-a566e439.js";import{c as f}from"./cartStore-f7e24b10.js";const{VITE_API:X,VITE_PATH:B}={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"weekhomeworks",BASE_URL:"/Vue-Homeworks/week6/dist",MODE:"production",DEV:!1,PROD:!0},S={methods:{...k(f,["getCart"]),createOrder(e){const c=`${X}/api/${B}/order`;this.$http.post(c,{data:{user:{name:e.姓名,email:e.email,tel:e.電話,address:e.地址},message:e.留言}}).then(i=>{alert(i.data.message),this.$refs.form.resetForm(),this.getCart()}).catch(i=>{alert(i.response.data.message)})}}},T={class:"mb-3"},A=t("label",{for:"email",class:"form-label"},"Email",-1),q={class:"mb-3"},O=t("label",{for:"name",class:"form-label"},"收件人姓名",-1),P={class:"mb-3"},D=t("label",{for:"tel",class:"form-label"},"收件人電話 (09XXXXXXXX)",-1),F={class:"mb-3"},N=t("label",{for:"address",class:"form-label"},"收件人地址",-1),H={class:"mb-3"},L=t("label",{for:"message",class:"form-label"},"留言",-1),M=t("div",{class:"text-end"},[t("button",{type:"submit",class:"btn btn-danger"},"送出訂單")],-1);function j(e,c,i,V,E,b){const l=m("V-field"),n=m("ErrorMessage"),u=m("V-form");return o(),C(u,{ref:"form",class:"col-md-6",onSubmit:b.createOrder},{default:w(({errors:s})=>[t("div",T,[A,a(l,{id:"email",name:"email",type:"email",placeholder:"請輸入 Email",class:p(["form-control",{"is-invalid":s.email}]),rules:"required|email"},null,8,["class"]),a(n,{name:"email",class:"invalid-feedback"})]),t("div",q,[O,a(l,{id:"name",name:"姓名",type:"text",placeholder:"請輸入姓名",class:p(["form-control",{"is-invalid":s.姓名}]),rules:"required"},null,8,["class"]),a(n,{name:"姓名",class:"invalid-feedback"})]),t("div",P,[D,a(l,{id:"tel",name:"電話",type:"tel",placeholder:"請輸入電話",class:p(["form-control",{"is-invalid":s.電話}]),rules:"required|phone"},null,8,["class"]),a(n,{name:"電話",class:"invalid-feedback"})]),t("div",F,[N,a(l,{id:"address",name:"地址",type:"text",placeholder:"請輸入地址",class:p(["form-control",{"is-invalid":s.地址}]),rules:"required"},null,8,["class"]),a(n,{name:"地址",class:"invalid-feedback"})]),t("div",H,[L,a(l,{as:"textarea",id:"message",name:"留言",class:"form-control",cols:"30",rows:"10"})]),M]),_:1},8,["onSubmit"])}const R=y(S,[["render",j]]),z={methods:{...k(f,["getCart","deleteCart","updateCart"])},computed:{...$(x,["loadings","isLoading"]),...$(f,["cart"])},mounted(){this.getCart()},components:{OrderForm:R}},U=t("h4",{class:"text-center"},"這裡是 前台 購物車",-1),G={class:"text-end"},J=["disabled"],K={class:"table align-middle"},Q=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",{class:"ps-5"},"單價"),t("th",null,"小計")])],-1),W=["disabled","onClick"],Y={key:0,class:"text-success"},Z={class:"input-group input-group-sm"},tt={class:"input-group"},et=["disabled","value","onBlur"],st={class:"input-group-text",id:"basic-addon2"},at={class:"ps-5"},ot={class:"text-end"},lt={key:0,class:"text-success"},nt=t("td",{colspan:"4",class:"text-end"},"總計",-1),dt={class:"text-end"},rt={key:0},ct=t("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),it={class:"text-end text-success"},_t={class:"my-5 row justify-content-center"};function mt(e,c,i,V,E,b){var u;const l=m("font-awesome-icon"),n=m("order-form");return o(),d(v,null,[U,t("div",G,[t("button",{class:"btn btn-outline-danger",type:"button",disabled:!((u=e.cart.carts)!=null&&u.length),onClick:c[0]||(c[0]=s=>e.deleteCart())},"清空購物車",8,J)]),t("table",K,[Q,t("tbody",null,[e.cart.carts?(o(!0),d(v,{key:0},I(e.cart.carts,s=>(o(),d("tr",{key:s.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:s.id===e.loadings.loadingCartId,onClick:g=>e.deleteCart(s.id)},[s.id===e.loadings.loadingCartId?(o(),C(l,{key:0,icon:["fas","spinner"],spin:""})):_("",!0),h(" x ")],8,W)]),t("td",null,[h(r(s.product.title)+" ",1),s.coupon?(o(),d("div",Y," 已套用優惠券 ")):_("",!0)]),t("td",null,[t("div",Z,[t("div",tt,[t("input",{min:"1",type:"number",class:"form-control",disabled:s.id===e.loadings.loadingCartId,value:s.qty,onBlur:g=>e.updateCart(s,g.target.value)},null,40,et),t("span",st,r(s.product.unit),1)])])]),t("td",at,r(s.product.price),1),t("td",ot,[e.cart.total>e.cart.final_total?(o(),d("small",lt,"折扣價：")):_("",!0),h(" "+r(s.final_total),1)])]))),128)):_("",!0)]),t("tfoot",null,[t("tr",null,[nt,t("td",dt,r(e.cart.total),1)]),e.cart.total>e.cart.final_total?(o(),d("tr",rt,[ct,t("td",it,r(e.cart.final_total),1)])):_("",!0)])]),t("div",_t,[a(n)])],64)}const ht=y(z,[["render",mt]]);export{ht as default};
